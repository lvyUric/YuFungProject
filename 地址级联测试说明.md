# 地址级联选择器测试说明

## 🚀 快速测试

### 1. 启动前端项目
```bash
cd stelory-admin
npm start
```

### 2. 测试步骤

#### 新增公司测试
1. 访问公司管理页面
2. 点击"新增公司"按钮
3. 在"地址信息"部分测试级联功能：

**测试案例 1：直辖市（北京）**
- 选择"北京市"作为省份
- 系统应自动选择"北京市"作为城市
- 然后可以选择区县（如"海淀区"、"朝阳区"等）

**测试案例 2：省份（广东省）**
- 选择"广东省"作为省份
- 城市下拉框应显示"广州市"、"深圳市"等选项
- 选择"广州市"后，区县下拉框应显示"天河区"、"越秀区"等选项

**测试案例 3：其他省份**
- 选择"江苏省"作为省份
- 城市下拉框应显示"南京市"、"无锡市"等选项
- 选择城市后应加载对应的区县

### 3. 验证要点

#### ✅ 正常级联行为
- [ ] 选择省份后，城市下拉框变为可用状态并加载对应城市
- [ ] 选择城市后，区县下拉框变为可用状态并加载对应区县  
- [ ] 直辖市选择后自动选择对应城市
- [ ] 重新选择省份时，城市和区县会清空重置

#### ✅ 表单验证
- [ ] 省市县为必填项，显示红色星号
- [ ] 未选择时提交表单会显示验证错误
- [ ] 详细地址（中文）为必填项

#### ✅ 编辑回显
- [ ] 编辑已有公司时，地址信息正确回显到级联选择器
- [ ] 可以修改任意级别的地址选择

## 🔧 调试信息

### 浏览器控制台日志
打开浏览器开发者工具(F12)，在控制台中可以看到以下调试信息：
- `AddressSelector: Initializing with value:` - 组件初始化信息
- `Found province code: xxx for province: xxx` - 省份代码查找结果
- `Loaded cities for province: x` - 省份对应的城市数量
- `Province selected, cities loaded: x` - 手动选择省份后的城市加载情况
- `City selected, districts loaded: x` - 选择城市后的区县加载情况

### 数据验证
级联选择器会同时保存中英文地址信息：
```json
{
  "province": "广东省",
  "city": "广州市", 
  "district": "天河区",
  "provinceEn": "Guangdong Province",
  "cityEn": "Guangzhou",
  "districtEn": "Tianhe District"
}
```

## 🌟 支持的地区

目前数据包含以下主要地区：

### 直辖市
- 北京市（16个区）
- 天津市（16个区）  
- 上海市（16个区）
- 重庆市（26个区县）

### 省份
- 广东省（广州市11个区、深圳市10个区、韶关市等）
- 江苏省（南京市11个区、无锡市7个区等）
- 浙江省（杭州市13个区县市等）

## 🐛 常见问题

### 问题1：级联选择器不工作
**症状**：选择省份后城市下拉框仍然是禁用状态

**排查步骤**：
1. 检查浏览器控制台是否有JavaScript错误
2. 查看控制台日志，确认地区数据是否正确加载
3. 确认选择的省份在 `chinaRegions.ts` 数据中存在

### 问题2：编辑时地址不回显
**症状**：编辑公司时地址级联选择器显示为空

**排查步骤**：
1. 确认后端返回的地址数据格式正确
2. 检查地址字段名称是否匹配（`address_cn_province` 等）
3. 查看控制台日志确认初始化过程

### 问题3：数据不匹配
**症状**：某些地区名称找不到对应的代码

**解决方案**：
1. 检查 `chinaRegions.ts` 中是否包含该地区
2. 确认地区名称完全匹配（包括"市"、"区"、"县"等后缀）
3. 必要时添加缺失的地区数据

## 📝 扩展地区数据

如需添加新的地区：

```typescript
// 在 chinaRegions.ts 中按以下格式添加
{
  code: "新的地区代码",
  name: "地区中文名",
  nameEn: "地区英文名",
  children: [
    // 子级地区数据...
  ]
}
```

确保：
- 代码唯一且遵循国标编码规范
- 中英文名称准确
- 层级关系正确（省-市-区县）

---

**测试时间**：每次修改地址相关代码后
**预期时间**：5-10分钟完成基础功能测试
**关键指标**：级联选择正常工作，数据正确保存和回显 